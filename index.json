{
  "index.html": {
    "href": "index.html",
    "title": "温熱環境シミュレーション機能",
    "summary": "温熱環境シミュレーション機能 「温熱環境シミュレーション機能」は、3D都市モデル及び樹木データを活用し、ビル壁面や地面の温度などの外力を設定し、対象エリアの温熱環境のシミュレーションを行い、温度、湿度、WBGTを算出する機能です。"
  },
  "manual/devMan.html": {
    "href": "manual/devMan.html",
    "title": "環境構築手順書",
    "summary": "環境構築手順書 1 本書について 本書では、温熱環境シミュレーション機能（以下「本システム」という。）の利用環境構築手順について記載しています。本システムは、PLATEAUの3D都市モデルおよび樹木データを活用し、対象エリアの温熱環境のシミュレーションを行う機能です。 2 動作環境 本システムのWebアプリケーションサーバサイドの動作環境は以下のとおりです。 項目 最小動作環境 推奨動作環境 OS Amazon Linux 2023 以上（AWS EC2） 同左 CPU EC2 インスタンスタイプに依存 同左 メモリ EC2 インスタンスタイプに依存（4GB 以上） 同左 ストレージ AWS S3 同左 クライアント（ブラウザ）の動作環境は以下のとおりです。 項目 動作環境 ブラウザ Google Chrome 最新版 本システムで使用するソフトウェアおよびサービスの一覧は以下のとおりです。 種別 名称 バージョン 内容 オープンソースソフトウェア PostGIS 3.4.1 PostgreSQLで位置情報を扱うことを可能とする拡張機能 オープンソースソフトウェア OpenFOAM v2506 オープンソースの数値流体計算（CFD）ソフトウェア。温熱環境シミュレーションの計算エンジン オープンソースライブラリ CesiumJS 1.136 3Dビューワ上にデータを描画するためのライブラリ オープンソースRDBMS PostgreSQL 16.2 各種配信するデータを格納するリレーショナルデータベース 商用ソフトウェア Cesium ion - 3Dデータの変換と配信のクラウドサービス クラウドサービス Firebase - 認証機能を提供するクラウドサービス 3 事前準備 本システムで利用する下記のソフトウェア・サービスを準備します。 （1）データベースの準備 こちらを利用してPostgreSQLサーバを起動します。その上で、位置情報を扱うための拡張機能である PostGIS をインストールします。 （2）Webサーバの準備 こちらを利用してWebサーバを起動します。ビルド済みのフロントエンド資材を配信するためのドキュメントルートを設定してください。 （3）Node.js の準備 こちらからNode.js LTS版（v20以上）をインストールします。フロントエンドのビルドに使用します。 （4）Firebase プロジェクトの準備 Firebase コンソールで新規プロジェクトを作成します。Authentication を有効化し、メール/パスワード認証プロバイダを有効にします。プロジェクトの設定画面から API キーや Auth ドメインなどの接続情報を控えてください。 （5）Cesium ion の準備 Cesium ion のアカウントを取得し、3D都市モデルデータ（建物・樹木等）をアップロードします。タイル変換処理が完了したら、アセットIDとアクセストークンを控えてください。 （6）OpenFOAM のインストール シミュレーション計算サーバ（Linux 64bit）に OpenFOAM v2506 をインストールします。インストール手順は公式サイトを参照してください。 4 インストール手順 （1）リポジトリの取得 こちらから温熱環境シミュレーション機能のソースコードをダウンロードします。 （2）環境変数の設定 プロジェクトルート直下に .env ファイルを作成し、以下の環境変数を設定します。 VITE_API_ENDPOINT=<バックエンドAPIのエンドポイント> VITE_FIREBASE_API_KEY=<FirebaseのAPIキー> VITE_FIREBASE_AUTH_DOMAIN=<FirebaseのAuthドメイン> VITE_FIREBASE_PROJECT_ID=<FirebaseのプロジェクトID> VITE_FIREBASE_STORAGE_BUCKET=<FirebaseのStorageバケット> VITE_FIREBASE_APP_ID=<FirebaseのアプリID> VITE_FIREBASE_MEASUREMENT_ID=<Firebaseの計測ID> VITE_CESIUM_ION_TOKEN=<Cesium ionのアクセストークン> VITE_CESIUM_ASSET_ID=<アセットID> （3）依存ライブラリのインストールとビルド 依存パッケージをインストールし、本番用ビルドを実行します。 npm install npm run build ビルド成果物は dist ディレクトリに出力されます。 （4）Webサーバへの配置 dist ディレクトリの内容を、3（2）で準備したWebサーバのドキュメントルートに配置します。 また、ドキュメントルートに以下の内容で .htaccess ファイルを作成してください。 RewriteEngine On RewriteBase / RewriteCond %{REQUEST_FILENAME} !-f RewriteCond %{REQUEST_FILENAME} !-d RewriteRule . /index.html [L] 注記 本システムは SPA（シングルページアプリケーション）のため、/project/123 のような URL に直接アクセスするとサーバ側にファイルが存在せず 404 エラーになります。上記の設定により、すべてのリクエストを index.html に転送し、画面の描画を JavaScript 側に委ねます 5 OpenFOAM 樹木モデルの構築 本システムのシミュレーション計算には、OpenFOAM 標準ソルバーに樹木モデル（canopyModels_v2506）を追加した環境が必要です。OpenFOAM 計算サーバ（Linux 64bit）で以下の手順を実施してください。 （1）樹木モデルのコンパイル リポジトリに同梱されている canopyModels_v2506_tar.gz を展開し、OpenFOAM の wmake でコンパイルします。コンパイルが成功すると $FOAM_USER_LIBBIN/libpreFlowModels.so が生成されます。 （2）計算ケースへの組み込み 計算ケースの system/controlDict に生成したライブラリを読み込む設定を追加し、constant/fvOptions に樹木モデルのソース項を設定します。 （3）シミュレーションの実行 設定完了後、buoyantBoussinesqSimpleFoam ソルバーを実行します。1回のシミュレーション実行には数時間程度を要します。計算完了後、バックエンドAPIが結果を読み取り、フロントエンドのレポート画面に反映します。 6 バックエンドAPIの構築 PostgreSQLに接続し、本システム用のデータベースを作成します。PostGIS拡張を有効化した上で、バックエンドAPIの実装に合わせてテーブルを作成してください。バックエンドAPIはシミュレーションプロジェクトの管理およびOpenFOAM計算処理のトリガーを担います。 7 初期データの投入 本システムの稼働に必要なデータを投入します。 （1）3D都市モデルデータの登録 3D都市モデル（建物モデル・樹木モデル等）を Amazon S3 にアップロードします。 （2）ユーザの登録 Firebase コンソールまたはバックエンドAPIのユーザ管理機能から初期ユーザを登録します。 8 動作確認 WebサーバのURLにブラウザからアクセスし、ログイン画面が表示されることを確認します。登録したユーザでログインし、プロジェクト一覧画面が表示されることを確認してください。新規プロジェクトを作成し、地図上でシミュレーション対象領域を指定後、気温・湿度・風速・風向きなどの環境条件を入力してシミュレーションを実行します。"
  },
  "manual/userMan.html": {
    "href": "manual/userMan.html",
    "title": "操作マニュアル",
    "summary": "操作マニュアル 1 本書について 本書では、温熱環境シミュレーション機能の操作手順について記載しています。 2 使い方 2-1 ログイン画面 本システムを公開したURLにアクセスすると以下の画面が表示されます。設定したログインID（メールアドレス）、パスワードを入力することでシステムのメイン（樹木管理）画面が表示されます。 2-2 プロジェクト一覧画面 ① 新規プロジェクト登録 ・登録したプロジェクト一覧が表示されます ・右上「新規プロジェクト登録」から、新たなプロジェクトを登録します 2-3 対象エリア登録画面 ① 対象エリア登録 ・地図上でプロジェクトの対象エリアのおおよその位置をクリックして、エリア登録を行います。おおよそ500m四方が選択されます。 2-4 シミュレーション条件設定・実行画面 ① プロジェクト名称入力 ・プロジェクト名称を入力します ② 環境設定 ・気温、湿度、風速、風向きを設定します ③ 温度設定（表面） ・ビル壁面、地面、道路、水面の温度を設定します ④ 樹木配置 ・地図上の左上にある編集ボタンから、樹木を配置する場所を地図上でクリックすることで新たな樹木を配置することも可能です。 ⑤ シミュレーション実行 ・シミュレーション実行ボタンを押すと、設定した内容でシミュレーションを実行します。 2-5 シミュレーション結果可視化・ダウンロード ・プロジェクト一覧画面から、シミュレーション結果を確認することができます ① 設定 ・「設定」ボタンで保存したプロジェクトの設定・再実行を行います ② 結果 ・Cesiumによる可視化 ③ Glance ・Paraview Glanceによる可視化（別ブラウザが起動） ④ ダウンロード ・VTK、glTF形式をZIPでダウンロード"
  }
}